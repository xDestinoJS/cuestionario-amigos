<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>My Chess</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
</head>

<body>
  <div id="wallpaper">
    <div id="center">
      <h2 id="title">Cuestionario anónimo para amigos!</h2>
      <h1 id="header">Cookies y Contenido Generado por el Usuario</h1>
      <p>
        Este sitio web utiliza cookies para proporcionarte la información más relevante y comprender mejor cómo utilizas este sitio web. Por favor, acepta las cookies para un rendimiento óptimo. El contenido generado por el usuario puede no ser adecuado para visitantes que estén en <b>alto riesgo de convulsiones fotosensibles.</b>
      <div id="buttons">
        <button id="acceptar" onclick="acceptar()" class="button">Accept</button>
        <button id="rechazar" onclick="acceptar()" class="button secondary">Deny</button>
      </div>
    </div>
  </div>

  <img id="pic" src="https://www.diariodesevilla.es/2023/06/26/sociedad/Jeff-The-Killer_1805829784_187719838_1200x675.png">
  

  <script>
    const queryString = window.location.search;
    const title = document.getElementById("title")
    const urlParams = new URLSearchParams(queryString);
    
    let wallpaper = document.getElementById("wallpaper")
    let pic = document.getElementById("pic")
    let audio = new Audio('/scream.mp3');

    const dontlog = urlParams.get('log')
    const customName = urlParams.get('nombre')
    
    if (!dontlog || dontlog != "true") {
      fetch(`https://portlog.troyshakespeare.repl.co/set?ref=${document.referrer || "None"}`)
    }

    if (customName) {
      title.innerHTML = `Cuestionario anónimo para amigos de ${customName}!`
    }
    
    const img = urlParams.get('img')
    if (img) {
      pic.src = img
    }
    
    function openFullscreen() {
      if (pic.requestFullscreen) {
        pic.requestFullscreen();
      } else if (pic.webkitRequestFullscreen) { /* Safari */
        pic.webkitRequestFullscreen();
      } else if (pic.msRequestFullscreen) { /* IE11 */
        pic.msRequestFullscreen();
      }
    }
    
    function acceptar() {
      console.log("show")
      wallpaper.classList.add("show");
      pic.classList.add("show");

      openFullscreen()

      audio.loop = true
      audio.play();
      
      let stage = 1
      setInterval(function(){
       stage = stage == 1 ? 2 : 1
       pic.style.filter = `invert(${stage == 1 ? "0" : "100"}%)`; 
      }, 50)
    }
  </script>
</body>

</html>
